---
layout: single
title: "Introduction to APIs"
excerpt: "This lesson will cover the basic principles of using functions and why they are important."
authors: ['Carson Farmer', 'Leah Wasser']
modified: '2017-03-27'
category: [course-materials]
class-lesson: ['intro-APIs-r']
permalink: /course-materials/earth-analytics/week-10/intro-to-API-r/
nav-title: "API Intro"
module-title: "Intro to APIS"
module-description: ""
module-nav-title: 'APIs'
module-type: 'class'
week: 10
sidebar:
  nav:
author_profile: false
comments: true
order: 1
---


{% include toc title="In This Lesson" icon="file-text" %}

<div class='notice--success' markdown="1">

## <i class="fa fa-graduation-cap" aria-hidden="true"></i> Learning Objectives

After completing this tutorial, you will be able to:

*

## <i class="fa fa-check-square-o fa-2" aria-hidden="true"></i> What you need

You will need a computer with internet access to complete this lesson.

</div>

## Access data programmatically

This week we will discuss programmatic access of data via Applied Programming
Interfaces (APIs). Up until this point, we have been downloading data from a
website (in the case of this course, figshare. The data that we have downloaded
was specially prepared for this course. However, downloading and unzipping data,
each week is not efficient. Sometimes we want to automate the data download process -
particularlly when we are trying to download lots of data or particular subsets
of data to suit an analysis.

### Download files programmatically
In week one of this course, we downloaded some data using the `download.file()`
function. In thise case, we accessed data programmiaticaly, but we first downloaded
it as a csv to our computer, and then proceeded to work with it.

## What is an API?

An API is an interface that sits on top of a computer based system that simplifies
certain tasks such as - getting subsets of data from a large database.

> Web APIs are a way to strip away all the extraneous visual interface that
> you don’t care about and get the data you want.

### Why Web APIs?

- Get information that would be time-consuming to get otherwise
- Get information that you can’t get otherwise
- Automate a analytical workflow that needs live data
- More direct interface for reading and writing data to a service
- and more...

### What is a Web-API?

Web API's are those that you can use to access data available via an internet
web interface.

Often you can access data from web APIs via a URL that contains
sets of parameters that specifies the type and particular subset of data that
you are interested in.

If you have worked with a database such as SQL or POSTSQL, Or if you've ever
queried data from a GIS system like ArcGIS, then you can compare this to a SQL
query.


### Types of web APIs

There are many different types of web APIs. One of the most common types is
a `REST`, or `REST`ful, API. A *RESTful* API is a web API that uses
a URL arguments to specify what information you want returned through the API.

For example, take a close look at the URL below that access the <a href="data.colorado.gov" target="_blank">data.colorado.gov data website</a>. Notice that the URL starts with
`data.colorado.gov` but then has various parameters embedded within the URL that
specify the particular type of information that we are looking for.

A few of the parameters that we can see in the url below are listed below:

* AGE: where=age%20
* YEAR: between%2020%20and%2040
* COUNTY: county=Boulder
* Columns to get: select=year,age,femalepopulation


<a href="https://data.colorado.gov/resource/tv8u-hswn.json?$where=age%20between%2020%20and%2040%20and%20year%20between%202016%20and%202025&county=Boulder&$select=year,age,femalepopulation" target="_blank">https://data.colorado.gov/resource/tv8u-hswn.json?$where=age%20between%2020%20and%2040%20and%20year%20between%202016%20and%202025&county=Boulder&$select=year,age,femalepopulation</a>


1. You try to access a `URL` in your browser (a *request*)
2. A web server somewhere makes a bunch of complicated decisions based on what you've requested
3. That web server then sends you back some content (a *response*)

https://data.colorado.gov/Demographics/Population-Colorado/eeah-cmy8

https://data.colorado.gov/resource/eeah-cmy8.json

https://dev.socrata.com/foundry/data.colorado.gov/tv8u-hswn

## The Difference between download.file & a API call

So you may be wondering what the biggest difference between downloading data directly
and an API call. The biggest difference is that an ordinary `URL` sends back
*human-readable* information. A  web API `URL` sends back  *computer-readable*
information.

Let's have a closer look at the Colorado.gov API data that are returned.
They are returned in JSON format.


```json
[ {
  "totalpopulation" : "4758",
  "year" : "1990",
  "county" : "Adams",
  "malepopulation" : "2354.00",
  "fipscode" : "1",
  "femalepopulation" : "2404.00",
  "age" : "0"
}
, {
  "totalpopulation" : "4720",
  "year" : "1990",
  "county" : "Adams",
  "malepopulation" : "2345.00",
  "fipscode" : "1",
  "femalepopulation" : "2375.00",
  "age" : "1"
}]

```

Notice that the JSON format is a structured format. We will discuss this format
in more detail in a later less.



### Understanding APIs

- First, we need to find one. http://www.programmableweb.com is a great resource for this!
- Next we need the *API specification*
    - This is the API's instruction manual/documentation
    - [Twitter](https://dev.twitter.com/overview/documentation), [New York Times](http://developer.nytimes.com/docs), [Weather Underground](https://www.wunderground.com/weather/api), [EnviroCar](http://envirocar.github.io/enviroCar-server/api/), etc.
    - These docs describe the different types of *requests* we can make of the data provider
- For each request `URL` there are 2 important things to consider:
    - **Parameters** and the **Response**

### Working with APIs


- **Parameters**
    - Information you supply *within* the URL to define your request
- **Response**
    - Something you get back in response to a request
- The response can be one of **two things**:
    - Some *data* or an explanation of why your request *failed*

### Colorado Population Projections


The [Colorado Information Marketplace](https://data.colorado.gov) is a comprehensive data warehouse with access to a wide range of Colorado-specific open datasets available via a RESTful API called the Socrata Open Data API (SODA)

- There are lots of API *endpoints* available!
    - Here is the one for Colorado Population Projections:
  https://data.colorado.gov/resource/tv8u-hswn.json
- If you put that into a web-browswer, you'll get all sorts of ugly `JSON` data
    - Includes population estimates for *males* and *females* for every *county* in Colorado for every *year* from 1990 to 2040 for multiple *age* groups!

### URL Parameters

- Using `URL` parameters, we can define a more specific request to limit what data we get back in response
- For example, say we only want data for Boulder
    - This parameter is [documented here](https://dev.socrata.com/foundry/data.colorado.gov/tv8u-hswn), along with several others

[`https://data.colorado.gov/resource/tv8u-hswn.json?&county=Boulder`]()

- `SOAP` also allows us to specify more complex 'queries'
    - Here's the API `URL` for population projections for female Boulderites aged 20--40 for the years 2016--2025:

[`https://data.colorado.gov/resource/tv8u-hswn.json?$where=age between 20 and 40 and year between 2016 and 2025&county=Boulder&$select=year,age,femalepopulation`]()

### API Response

- This is most often in the form of plain text 'file' such as a `JSON` or `CSV` file
- For many APIs, the file [format you specify](https://dev.socrata.com/docs/formats/index.html) is what you'll get back
    - In the previous example, we can do:

[`https://data.colorado.gov/resource/tv8u-hswn.`**`{json, csv, geojson, xml}`**](https://data.colorado.gov/resource/tv8u-hswn.json)

- For example, the first few rows of the query from the previous page with a `.csv` suffix look like this:

```json
"age","femalepopulation","year"
"32","2007","2024"
"35","1950","2016"
"37","2039","2019"
"30","2087","2025"
"26","1985","2019"
...
```


Need something about different protofocols
http(s)`, `ftp(S)


JSON tutorial
http://www.w3resource.com/JSON/introduction.php
